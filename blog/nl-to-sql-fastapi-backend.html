<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ask Your Database – NL to SQL Backend</title>

  <!-- Bootstrap 5 -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  >

  <!-- Blog-only CSS -->
  <link rel="stylesheet" href="index.css">
</head>
<body>

<!-- Mobile Navbar -->
<nav class="navbar navbar-light d-lg-none px-3">
  <span class="navbar-brand fw-bold">sarcastikant</span>
  <button
    class="btn btn-outline-dark"
    data-bs-toggle="offcanvas"
    data-bs-target="#mobileMenu"
  >
    ☰
  </button>
</nav>

<!-- Mobile Sidebar -->
<div class="offcanvas offcanvas-end" id="mobileMenu">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title">Menu</h5>
    <button class="btn-close" data-bs-dismiss="offcanvas"></button>
  </div>

  <div class="offcanvas-body">
    <ul class="nav flex-column sidebar-links">
      <li><a href="../index.html">Home</a></li>

      <li class="mt-3 sidebar-heading">Blogs</li>
      <li>
        <a href="nl-to-sql-fastapi-backend.html" class="active-blog">
          Ask Your Database
          <span class="blog-subitem">NL → SQL Backend</span>
        </a>
      </li>
               <li>
        <a href="role-based-lms-nextjs-backend.html">
           Lead Management System
          <span class="blog-subitem">Auth · Roles · APIs</span>
        </a>
      </li>

      <li class="mt-4 sidebar-heading">Let's Connect</li>
      <li><a href="https://github.com/shashikant190" target="_blank">GitHub</a></li>
      <li><a href="https://x.com/sarcastikant" target="_blank">Twitter</a></li>
      <li><a href="https://www.linkedin.com/in/sarcastikant/" target="_blank">LinkedIn</a></li>
    </ul>
  </div>
</div>

<!-- Layout -->
<div class="container-fluid">
  <div class="row">

    <!-- Main Content -->
    <main class="col-lg-9 px-5 py-5 content blog">



      <h1>Ask Your Database: Query PostgreSQL Using Plain English</h1>

      <p class="blog-subtitle">
        <a href="https://shashikant190.github.io/AskDB/">
          Building a multi-project Natural Language → SQL backend with FastAPI
        </a>
      </p>

      <p>
        <strong>Ask Your Database</strong> is a backend system that allows users
        to query their own PostgreSQL databases using plain English instead of SQL.
        The system converts natural language into constrained SQL, executes it
        safely, and returns structured JSON results.
      </p>

      <ul>
        <li>“Show me all profiles created last 7 days”</li>
        <li>“Total expenses this month”</li>
        <li>“Count events in last 30 days”</li>
      </ul>

      <h2>Why I Built This</h2>
      <p>
        Most analytics dashboards assume fixed schemas and predefined SQL queries.
        That assumption breaks down when the backend must operate on
        <em>unknown databases</em> provided by users.
      </p>

      <p>
        My goal was not to build a “smart” system, but a backend that is
        <strong>predictable, safe, and debuggable</strong> even when user input
        is ambiguous.
      </p>

      <h2>High-Level Architecture</h2>

      <div class="architecture-box">
        <img
          src="../assets/diagrams/fastapiArchitecture.png"
          alt="NL to SQL Architecture Diagram"
          class="img-fluid architecture-img"
        >
      </div>

      <h2>Understanding the Core Risk</h2>
      <p>
        Natural-language-to-SQL systems fail in dangerous ways when they blindly
        trust user intent. Without constraints, a single query can trigger
        full-table scans, invalid SQL, or unintended data access.
      </p>

      <h2>How the Backend Learns the Database Shape</h2>
      <p>
        Before generating SQL, the backend inspects the connected database and
        builds an in-memory representation of tables and columns. This ensures
        that every query is grounded in the real schema.
      </p>

      <pre><code class="language-python">
insp = inspect(engine)

for table in insp.get_table_names():
    cols = insp.get_columns(table)
      </code></pre>

      <p>
        This eliminates guesswork and ensures the system only queries
        tables and fields that actually exist.
      </p>

      <h2>Isolating Projects to Prevent Data Leaks</h2>
      <p>
        In multi-project systems, sharing database connections can silently
        route queries to the wrong database. This is one of the most
        dangerous failure modes in backend systems.
      </p>

      <pre><code class="language-python">
active_engines[project] = create_engine(url)
      </code></pre>

      <p>
        Each project gets its own database engine and schema state,
        enforcing isolation at the infrastructure level.
      </p>

      <h2>Why SQL Generation Is Intentionally Boring</h2>
      <p>
        The system avoids complex or “clever” SQL. Queries are deterministic,
        schema-constrained, and always limited by default.
      </p>

      <pre><code>
SELECT * FROM profiles
WHERE created_at >= NOW() - INTERVAL '7 days'
LIMIT 100;
      </code></pre>

      <p>
        This trade-off favors safety and predictability over intelligence.
      </p>

      <h2>How a Query Becomes Safe SQL</h2>

      <div class="architecture-box">
        <img
          src="../assets/diagrams/queryToSQLFlow.png"
          alt="Natural Language to Safe SQL Flow"
          class="img-fluid architecture-img"
        >
      </div>

      <p>
        Each step validates intent against schema, project isolation,
        and deterministic rules before executing any SQL.
      </p>

      <h2>Lessons Learned</h2>
      <ul>
        <li>Schema awareness is mandatory for NL → SQL systems</li>
        <li>Isolation must be enforced in code, not conventions</li>
        <li>Predictable systems outperform “smart” but unsafe ones</li>
      </ul>

      <!-- <h2>What’s Next</h2>
      <p>
        Future versions will introduce LLM-based parsing, join inference,
        and role-based query constraints — while preserving the same
        safety-first architecture.
      </p> -->

      <h2>Screenshots</h2>

      <p>
        A few snapshots showing the system in action.
      </p>

      <div class="row g-4 screenshots-grid">
        <div class="col-md-6">
          <img
            src="../assets/screenshots/AskDBUI.png"
            alt="AskDB UI"
            class="img-fluid screenshot-img"
          >
        </div>

        <div class="col-md-6">
          <img
            src="../assets/screenshots/QueryResult.png"
            alt="Query Result"
            class="img-fluid screenshot-img"
          >
        </div>
      </div>

    </main>

    <!-- Desktop Sidebar -->
    <aside class="col-lg-3 d-none d-lg-block sidebar px-4 py-5">
      <ul class="nav flex-column sidebar-links">
        <li><a href="../index.html">Home</a></li>

        <li class="mt-3 sidebar-heading">Blogs</li>
        <li>
          <a href="nl-to-sql-fastapi-backend.html" class="active-blog">
            Ask Your Database<br>
            <span class="blog-subitem">NL → SQL Backend</span>
          </a>
        </li>
        <li>
        <a href="role-based-lms-nextjs-backend.html">
           Lead Management System
          <span class="blog-subitem">Auth · Roles · APIs</span>
        </a>
      </li>

        <li class="mt-4 sidebar-heading">Let's Connect</li>
        <li><a href="https://github.com/shashikant190" target="_blank">GitHub</a></li>
        <li><a href="https://x.com/sarcastikant" target="_blank">Twitter</a></li>
        <li><a href="https://www.linkedin.com/in/sarcastikant/" target="_blank">LinkedIn</a></li>
      </ul>
    </aside>
<a href="index.html" class="back-link">← Back to Blogs</a>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
