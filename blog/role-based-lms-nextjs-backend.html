<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Building a Role-Based LMS ‚Äì Secure Backend with Next.js</title>

  <!-- Bootstrap 5 -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  >

  <!-- Blog-only CSS -->
  <link rel="stylesheet" href="index.css">
</head>
<body>

<!-- Mobile Navbar -->
<nav class="navbar navbar-light d-lg-none px-3">
  <span class="navbar-brand fw-bold">Shashikant</span>
  <button
    class="btn btn-outline-dark"
    data-bs-toggle="offcanvas"
    data-bs-target="#mobileMenu"
  >
    ‚ò∞
  </button>
</nav>

<!-- Mobile Sidebar -->
<div class="offcanvas offcanvas-end" id="mobileMenu">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title">Menu</h5>
    <button class="btn-close" data-bs-dismiss="offcanvas"></button>
  </div>

  <div class="offcanvas-body">
    <ul class="nav flex-column sidebar-links">
      <li><a href="../index.html">Home</a></li>

      <li class="mt-3 sidebar-heading">Blogs</li>
             <li>
          <a href="nl-to-sql-fastapi-backend.html" class="active-blog">
            Ask Your Database<br>
            <span class="blog-subitem">NL ‚Üí SQL Backend</span>
          </a>
        </li>
      <li>
        <a href="role-based-lms-nextjs-backend.html" class="active-blog">
          Lead Management System
          <span class="blog-subitem">Auth ¬∑ Roles ¬∑ Secure APIs</span>
        </a>
      </li>

      <li class="mt-4 sidebar-heading">Let's Connect</li>
      <li><a href="https://github.com/shashikant190" target="_blank">GitHub</a></li>
      <li><a href="https://x.com/sarcastikant" target="_blank">Twitter</a></li>
      <li><a href="https://www.linkedin.com/in/sarcastikant/" target="_blank">LinkedIn</a></li>
    </ul>
  </div>
</div>

<!-- Layout -->
<div class="container-fluid">
  <div class="row">

    <!-- Main Content -->
    <main class="col-lg-9 px-5 py-5 content blog">

      <h1>Building a Role-Based Lead Management System</h1>

      <p class="blog-subtitle">
        <strong>Note: I can't share the LIVE link of the system as it is internal system of the company in which i worked for. Thank you for Understanding!!!üòÄ</strong> (The emoji is added by me not by ChatGPT. hehe)
      </p>

      <p class="blog-subtitle">
        Designing secure authentication, authorization, and APIs using Next.js
      </p>

      <p>
        I built a <strong>Lead Management System (LMS)</strong> for internal business use
        to manage leads, associates, and users efficiently.
        The system focuses on <strong>security, role-based access control,
        and predictable backend behavior</strong>.
      </p>

      <p>
        Instead of relying on frontend checks, the LMS enforces
        authentication and authorization entirely at the backend.
      </p>

      <h2>What Problem This Solves</h2>
      <p>
        Many internal dashboards fail because they trust the frontend too much.
        Users can bypass UI restrictions, roles are checked only in the browser,
        and APIs assume requests are valid.
      </p>

      <p>
        This LMS was designed to avoid those failures by enforcing
        access control at every backend layer.
      </p>

      <h2>High-Level Architecture</h2>

      <!-- <div class="architecture-box">
        <p class="arch-placeholder">
          Client ‚Üí Next.js Middleware ‚Üí API Routes ‚Üí Role Checks ‚Üí SQL Database
        </p>
      </div> -->

            <div class="architecture-box">
        <img
          src="../assets/diagrams/lmsFlow.png"
          alt="LMS Architecture Diagram"
          class="img-fluid architecture-img"
        >
      </div>

      <h2>Route Protection with Next.js Middleware</h2>
      <p>
        The first layer of security is implemented using Next.js middleware.
        Protected routes like <code>/dashboard</code> cannot be accessed
        without a valid authentication token.
      </p>

      <pre><code class="language-ts">
if (pathname.startsWith('/dashboard')) {
  if (!token) {
    return NextResponse.redirect(new URL('/login', req.url));
  }
}
      </code></pre>

      <p>
        Middleware blocks unauthorized users early and prevents unnecessary
        backend calls.
      </p>

      <h2>Secure Authentication Flow</h2>
      <p>
        User passwords are hashed using <strong>bcrypt</strong>.
        On login, credentials are verified securely before issuing a JWT.
      </p>

      <pre><code class="language-ts">
const isValid = await comparePassword(password, user.PasswordHash);
      </code></pre>

      <p>
        Tokens are stored in <strong>HTTP-only cookies</strong>,
        protecting them from JavaScript access and XSS attacks.
      </p>

      <h2>Token Validation at API Level</h2>
      <p>
        Every API route independently validates the JWT token.
        Middleware only checks presence ‚Äî APIs enforce trust.
      </p>

      <pre><code class="language-ts">
const decoded = verifyToken(token);
      </code></pre>

      <p>
        This ensures that even if middleware is bypassed,
        APIs remain protected.
      </p>

      <h2>Role-Based Authorization</h2>
      <p>
        Certain actions like creating, updating, or deleting records
        are restricted to privileged roles (e.g. <strong>Lead Master</strong>).
      </p>

      <pre><code class="language-ts">
if (decoded.role !== 'Lead Master') {
  return NextResponse.json({ error: 'Unauthorized' }, { status: 403 });
}
      </code></pre>

      <p>
        Role checks live in backend code, not UI logic.
      </p>

      <h2>Controlled Data Access</h2>
      <p>
        Admin users can view all associates,
        while regular users only see records assigned to them.
      </p>

      <pre><code class="language-sql">
SELECT *
FROM Associates
WHERE AssignedTo = @userId
      </code></pre>

      <p>
        This prevents accidental data leaks and enforces ownership rules.
      </p>

      <h2>Safe Database Operations</h2>
      <p>
        All database queries use parameterized SQL to prevent injection
        and maintain predictable query behavior.
      </p>

      <h2>Lessons Learned</h2>
      <ul>
        <li>Middleware should protect routes, not establish trust</li>
        <li>Authorization must live in backend code</li>
        <li>Role-based access is non-negotiable in internal tools</li>
        <li>Predictable systems are easier to debug and secure</li>
      </ul>

      <!-- <h2>What‚Äôs Next</h2>
      <p>
        Future improvements include audit logs, soft deletes,
        token refresh mechanisms, and finer-grained permissions.
      </p> -->

      <h2>Screenshots</h2>
      <p>
        A few snapshots of the LMS dashboard and workflows.
      </p>

      <div class="row g-4 screenshots-grid">
        <div class="col-md-6">
          <img
            src="../assets/screenshots/AdminDashboardLMS.png"
            alt="LMS Dashboard"
            class="img-fluid screenshot-img"
          >
        </div>

        <div class="col-md-6">
          <img
            src="../assets/screenshots/UserDashboardLMS.png"
            alt="Associates Management"
            class="img-fluid screenshot-img"
          >
        </div>
      </div>

    </main>

    <!-- Desktop Sidebar -->
    <aside class="col-lg-3 d-none d-lg-block sidebar px-4 py-5">
      <ul class="nav flex-column sidebar-links">
        <li><a href="../index.html">Home</a></li>

        <li class="mt-3 sidebar-heading">Blogs</li>
               <li>
          <a href="nl-to-sql-fastapi-backend.html" class="active-blog">
            Ask Your Database<br>
            <span class="blog-subitem">NL ‚Üí SQL Backend</span>
          </a>
        </li>
        <li>
          <a href="role-based-lms-nextjs-backend.html" class="active-blog">
            Lead Management System<br>
            <span class="blog-subitem">Auth ¬∑ Roles ¬∑ APIs</span>
          </a>
        </li>

        <li class="mt-4 sidebar-heading">Let's Connect</li>
        <li><a href="https://github.com/shashikant190" target="_blank">GitHub</a></li>
        <li><a href="https://x.com/sarcastikant" target="_blank">Twitter</a></li>
        <li><a href="https://www.linkedin.com/in/sarcastikant/" target="_blank">LinkedIn</a></li>
      </ul>
    </aside>

    <a href="index.html" class="back-link">‚Üê Back to Blogs</a>

  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
